---
- name: Print LDAP server-side commands (sudo + autofs)
  ansible.builtin.debug:
    msg: |
      This role no longer mutates LDAP server entries directly.
      Run these commands against your LDAP server (adjust host/DC/bind DN):

      Verify sudo rules are visible:
        ldapsearch -x -H "{{ openldap_server_uri }}" -D "{{ openldap_server_bind_dn }}" -W \
          -b "{{ openldap_sudo_search_base }}" '(objectClass=sudoRole)' cn sudoUser sudoHost sudoCommand sudoOption

      Example: create a sudoers OU (if missing):
        cat > sudoers-ou.ldif <<'LDIF'
        dn: {{ openldap_sudo_search_base }}
        objectClass: top
        objectClass: organizationalUnit
        ou: sudoers
        LDIF
        ldapadd -x -H "{{ openldap_server_uri }}" -D "{{ openldap_server_bind_dn }}" -W -f sudoers-ou.ldif

      Example: allow %admin full sudo on all hosts:
        cat > sudo-admin.ldif <<'LDIF'
        dn: cn=admin,{{ openldap_sudo_search_base }}
        objectClass: top
        objectClass: sudoRole
        cn: admin
        sudoUser: %admin
        sudoHost: ALL
        sudoCommand: ALL
        sudoOption: !authenticate
        LDIF
        ldapadd -x -H "{{ openldap_server_uri }}" -D "{{ openldap_server_bind_dn }}" -W -f sudo-admin.ldif

      Example: create automount OUs (if missing):
        ldapsearch -x -H "{{ openldap_server_uri }}" -D "{{ openldap_server_bind_dn }}" -W \
          -b "{{ openldap_autofs_search_base }}" '(objectClass=automountMap)' ou

      Notes:
        - Ensure the sudo schema is loaded on the LDAP server.
        - Consider using a dedicated, restricted bind DN for clients (read-only) instead of the admin DN.
